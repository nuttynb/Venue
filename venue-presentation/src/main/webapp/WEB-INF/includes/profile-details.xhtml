<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:outputScript library="js" name="calendar.js"/>
    <div class="box venue-name">#{userBean.name}#{msg['user.venue']}</div>
    <h:form id="form">
        <p:growl id="messages" showDetail="true" autoUpdate="true"/>
    </h:form>
    <p:panelGrid id="main-content-grid" styleClass="ui-panelgrid-blank" cellspacing="20" style="width: 100%;">
        <p:row>
            <p:column style="padding: 0;vertical-align: top;">
                <p:panelGrid id="left-side-bar" styleClass="left">
                    <p:row>
                        <p:column>
                            <ui:include src="profile-image.xhtml"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <ui:include src="type.xhtml"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <ui:include src="address.xhtml"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <div class="box">
                                <div class="box-header">#{msg['venue.image.upload']}</div>
                                <div class="box-content">
                                    <h:form>
                                        <p:fileUpload disabled="#{profileBean.disabled}"
                                                      fileUploadListener="#{fileUploadBean.fileUpload}"
                                                      uploadLabel="#{msg['fileupload.wizard.label.upload']}"
                                                      label="#{msg['fileupload.wizard.label.choose']}"
                                                      cancelLabel="#{msg['fileupload.wizard.label.cancel']}"
                                                      invalidSizeMessage="#{msg['fileupload.wizard.label.size']}"
                                                      mode="advanced"
                                                      dragDropSupport="true"
                                                      sizeLimit="4000000"
                                                      allowTypes="/(\.|\/)(gif|jpe?g|png)$/" multiple="true"
                                                      oncomplete="afterUploadingRemote();">
                                            <p:remoteCommand name="afterUploadingRemote"
                                                             actionListener="#{profileBean.onUpdateAfterUploading}"
                                                             update="@widgetVar(imageDialog) :right-side-bar"/>
                                        </p:fileUpload>
                                    </h:form>
                                </div>
                            </div>
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </p:column>
            <p:column styleClass="right" style="padding:0;width:100%;">
                <p:panelGrid id="right-side-bar" styleClass="no-padding">
                    <p:row>
                        <p:column>
                            <ui:include src="name.xhtml"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <ui:include src="description.xhtml"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:accordionPanel multiple="true" activeIndex="0,1,2">
                                <p:tab id="galleria-tab" title="#{msg['venue.images']}">

                                    <h:outputText value="#{msg['no.images']}"
                                                  rendered="#{venueImagesBean.images.isEmpty()}"/>
                                    <p:galleria value="#{venueImagesBean.images}" var="image"
                                                panelWidth="500" panelHeight="300"
                                                style="margin: 0 auto;"
                                                showCaption="true"
                                                rendered="#{!venueImagesBean.images.isEmpty()}" effect="puff"
                                                effectSpeed="3000" autoPlay="false" transitionInterval="500">
                                        <p:graphicImage id="galleria-image"
                                                        value="#{venueImagesLoader.image}" alt="#{image.name}"
                                                        title="#{image.name}" width="600">
                                            <f:param name="imageId" value="#{image.id}"/>
                                        </p:graphicImage>
                                    </p:galleria>
                                </p:tab>
                                <p:tab title="#{msg['venue.events']}">
                                    <p:schedule value="#{scheduleBean.eventModel}"
                                                editable="true"
                                                widgetVar="myschedule">
                                        <p:ajax disabled="#{profileBean.disabled}" event="dateSelect"
                                                listener="#{eventHandler.onDateSelect}"
                                                update="@widgetVar(eventDialog)"
                                                oncomplete="PF('eventDialog').show();"/>
                                        <p:ajax disabled="#{profileBean.disabled}" event="eventSelect"
                                                listener="#{eventHandler.onEventSelect}"
                                                update="@widgetVar(eventDialog)"
                                                oncomplete="PF('eventDialog').show();"/>
                                        <p:ajax disabled="#{profileBean.disabled}" event="eventMove"
                                                listener="#{eventHandler.onEventMove}"
                                                update="@widgetVar(eventDialog)"/>
                                        <p:ajax disabled="#{profileBean.disabled}" event="eventResize"
                                                listener="#{eventHandler.onEventResize}"
                                                update="@widgetVar(eventDialog)"/>
                                    </p:schedule>
                                </p:tab>
                                <p:tab title="#{msg['venue.location']}">
                                    <ui:include src="map.xhtml"/>
                                </p:tab>
                            </p:accordionPanel>
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </p:column>
        </p:row>
    </p:panelGrid>
    <p:dialog widgetVar="eventDialog" header="Event Details" showEffect="clip" hideEffect="clip">
        <h:form>
            <h:panelGrid id="eventDetails" columns="2">
                <h:outputLabel for="title" value="Title:"/>
                <p:inputText id="title" value="#{eventHandler.event.title}"/>

                <h:outputLabel for="from" value="From:"/>
                <p:calendar id="from" value="#{eventHandler.event.startDate}" pattern="dd/MM/yyyy HH:mm"/>

                <h:outputLabel for="to" value="To:"/>
                <p:calendar id="to" value="#{eventHandler.event.endDate}" pattern="dd/MM/yyyy HH:mm"/>

                <h:outputLabel for="description" value="Description:"/>
                <p:inputText id="description" value="#{eventHandler.event.description}"/>


                <h:outputLabel for="allDay" value="All Day:"/>
                <h:selectBooleanCheckbox id="allDay" value="#{eventHandler.event.allDay}"/>

                <h:outputLabel value="Select Type:"/>

                <p:selectOneMenu styleClass="centered-block centered-text" style="width:125px" required="true"
                                 value="#{eventHandler.event.styleClass}">
                    <f:selectItem itemLabel="#{msg['selectonemenu.select']}" itemValue=""/>
                    <!--<f:selectItems value="#{typeBean.eventTypes}" var="type"
                                   itemLabel="#{type.name}" itemValue="#{type.id}"/>-->
                </p:selectOneMenu>

                <p:commandButton type="reset" value="Reset"/>
                <p:commandButton value="Save" oncomplete="PF('eventDialog').hide(); PF('myschedule').update();"
                                 actionListener="#{eventHandler.addEvent}" />

            </h:panelGrid>
        </h:form>
        <h:form>
            <p:selectOneMenu styleClass="centered-block centered-text" style="width:125px" required="true"
                             value="#{eventHandler.event.styleClass}" converter="typeVoConverter"
                             requiredMessage="#{msg['venue.type']} #{msg['createvenue.wizard.requiredmessage']}">
                <f:selectItem itemLabel="#{msg['selectonemenu.select']}" itemValue=""/>
                <!--<f:selectItems value="#{typeBean.eventTypes}" var="type"
                               itemLabel="#{type.name}" itemValue="#{type.name}"/>-->
            </p:selectOneMenu>
            <p:commandButton styleClass="centered-block" value="#{msg['dialog.save']}"
                             oncomplete="if(!args.validationFailed){PF('typeDialog').hide();}"
                             icon="ui-icon-check" actionListener="#{eventHandler.addEvent}" process="@this, @form"/>
        </h:form>
    </p:dialog>
</ui:composition>
